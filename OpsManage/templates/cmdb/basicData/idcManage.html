{% extends "base.html" %}


{% block css_block %}
<link href="/static/dist/css/tab_css.css" type="text/css" rel="stylesheet">
<style type="text/css">
    .idcicon{
        color: #9e0505;
    }

    .idcinfo {
        min-height: 180px;
    }

    span.cabinfo {
        font-size: 12px;
    }

</style>

{% endblock css_block %}


{% block main_content %}

<ul id="tabs">
    <li id="org"><a href="http://127.0.0.1:8000/cmdb/orgManage">组织机构</a></li>
    <li id="idc"><a href="http://127.0.0.1:8000/cmdb/idcManage">机房管理</a></li>
    <li id="user"><a href="http://127.0.0.1:8000/cmdb/userManage">用户管理</a></li>
    <li id="contract"><a href="http://127.0.0.1:8000/cmdb/contractManage">合同管理</a></li>
    <li id="supplier"><a href="http://127.0.0.1:8000/cmdb/supplierManage">供应商管理</a></li>
    <li id="vendor"><a href="http://127.0.0.1:8000/cmdb/vendorManage">厂商管理</a></li>
</ul>

<div class="box box-group bg-gray-light">
    <div class="row" style="margin-top: 10px">

        {% for idc in IDC %}
        <div class="col-sm-6">
            <div class="box  box-warning">
                <!-- .box-header -->
                <div class="box-header with-border" >
                    <span class="idcicon fa fa-home"></span>
                    <h3 class="box-title">{{ idc.idc_name }}</h3>
                    <span class="fa fa-gear btn pull-right no-margin no-padding"
                          onclick="window.open('/cmdb/editIdc?idcId={{ idc.id }}')">
                    </span>
                </div>
                <!-- /.box-header -->

                <!-- .box-body -->
                <div class="box-body">
                    <div class="row">
                        <div class="idcinfo text col-sm-4 border-right no-margin" >
                            <span class="cabinfo">名称 : {{ idc.idc_name}}</span><br>
                            <span class="cabinfo">单位 : {{ idc.organization}}</span><br>
                            <span class="cabinfo">地址 : {{ idc.idc_address}}</span><br>
                            <span class="cabinfo">备注 : {{ idc.idc_memo}}</span><br>
                            {% for count in peridc_asset_count %}
                            {% if count.idc_name == idc.idc_name %}
                            <span class="cabinfo ">主机：【 {{ count.data.servercount }} 】台</span><br>
                            <span class="cabinfo ">网络：【 {{ count.data.netcount }} 】台</span><br>
                            <span class="cabinfo ">存储：【 {{ count.data.securitycount }} 】台</span><br>
                            <span class="cabinfo ">安全：【 {{ count.data.storgecount }} 】台</span><br>
                            {% endif %}
                            {% endfor %}
                        </div>

                        <div class="col-sm-8">
                            <div class="inline" id="{{ idc.id }}">
                                <span>机柜信息 :</span><br>

                                {% for cabinet in idc.cabinet_set.all %}
                                <label class="label label-default" style="font-size: 13px;width: 65px;display: inline-block">
                                    {{ cabinet.cabinet_name}}
                                </label>
                                {% endfor %}

<<<<<<< HEAD
=======
                     <div class="container" style="border: none;margin: 0;padding: 20px 60px 0;">
                        <form class="contact" action="idcManage" method="post">
                            <div class="row clearfix" style="float: left;">
                                <div class="ctrl" id="fenju" style="float: left;width:12em;margin-right: 2em;">
                                    <select  id="f" name="FenJu">
                                        <option value="0">请选择分局</option>
                                            <option value={{ zhongxianju.id }}>{{ zhongxianju.org_name }}</option>
                                        {% for Fenju in Fenjus %}
                                            <option value={{ Fenju.id }}>{{ Fenju.org_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="row clearfix" style="float: left;width:12em;margin-right: 2em;">
                                <div class="ctrl" id="guanlichu">
                                    <select   id="g" name="GuanLiChu" onchange="var args = $('#g').serialize();var x1 = '{%url 'cmdb:showXDZ'%}?' + args;$('#xiandizhan').load(x1 + ' #xiandizhan')">
                                        <option value="0">请选择管理处</option>
                                        {% for Guanlichu in Guanlichus %}
                                            <option value={{ Guanlichu.id}}>{{ Guanlichu.org_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="row clearfix" style="float: left;width:12em;">
                                <div class="ctrl" id="xiandizhan">
                                    <select id="x" name="XianDiZhan">
                                        <option value="0">请选择现地站</option>
                                        {% for Xiandizhan in Xiandizhans %}
                                            <option value={{ Xiandizhan.id}}>{{ Xiandizhan.org_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="row  clearfix" style="float: left;width: 4em;margin-left: 2em;height: 40px;">
                                <div class="ctrl">
                                    <input style="width: 4em;height: 40px;line-height: 26px; color: #FFFFFF;border-radius: 5px;" type="submit" class="btn btn-block btn-primary" value="筛选">
                                </div>
                            </div>
                        </form>
                    </div>


                    {% for idc in myIdcs %}
                        <div class="mybox mybox-teal" style="margin:2em;float:left;width: 40%;height: 240px;">
                            <div class="mybox-header">
                                <label for="CPU">{{ idc.idc_name }}</label>
                            </div>
                            <div class="mybox-body" style="height: 240px;">
                                <div style="float: left;width: 100%;line-height: 2em;">
                                    <label>机房名称 :</label>
                                    <span style="margin-left: 1em">{{ idc.idc_name}}</span><br>
                                    <label>机房地址 :</label>
                                    <span style="margin-left: 1em">{{ idc.idc_address}}</span><br>
                                    <label>备注信息 :</label>
                                    <span style="margin-left: 1em">{{ idc.idc_memo}}</span><br>
                                    <div id="{{ idc.id }}">
                                        <label>机柜信息 :</label>
                                        {% if cabFlag %}
                                            {% for c in myCabs %}
                                                <span style="margin-left: 1em">{{ c.cabinet_name }}</span>
                                            {% endfor %}
                                            <a onclick="window.open('http://127.0.0.1:8000/cmdb/cabDetail?idcId={{ idc.id }}')" style="margin-left: 1em">机柜图</a>
                                            <a target="_blank" href="http://127.0.0.1:8000/cmdb/editCab?idcId={{ idc.id }}"  style="margin-left: 1em"><i class="fa fa-edit">编辑</i></a>
                                            <a style="margin-left: 0.5em" onclick="$('#{{ idc.id }}').load(window.location.href+ ' #{{ idc.id }}')"><i class="fa fa-fw fa-refresh"></i></a>
                                        {% else %}
                                            <a onclick="var test = window.location.href;if(test.split('?')[1]) url=test+'&IDC={{ idc.id }}'; else url=test+'?IDC={{ idc.id }}';$('#{{ idc.id }}').load(url+ ' #{{ idc.id }}');" style="margin-left: 1em;line-height: 20px;" class="text-center">展示或编辑机柜信息</a>
                                        {% endif %}
                                    </div>
                                </div>
                                <button onclick="window.open('http://127.0.0.1:8000/cmdb/editIdc?idcId={{ idc.id }}')" style="position: absolute;left:85%;width: 10%;">编 辑</button>
                            </div>

                                <br><button class="btn btn-xs btn-primary margin-r-5 pull-right" onclick="window.open('http://127.0.0.1:8000/cmdb/cabDetail?idcId={{ idc.id }}')">机柜图</button>
>>>>>>> c05fe8bb68b7efd0498b5d17d87486202f6cdfbc

                                <!-- ------弹出机柜图------ -->
                            </div>
                            <div class="inline ">
                                <a target="blank" href="http://127.0.0.1:8000/cmdb/editCab?idcId={{ idc.id }}">
                                    <span class="fa fa-edit text-yellow media-middle" style="font-size: 18px"></span>
                                </a>
<<<<<<< HEAD
                            </div>
=======
                            {% else %}
                                <a onclick="var test = window.location.href;if(test.split('?')[1]) url=test+'&IDC={{ idc.id }}'; else url=test+'?IDC={{ idc.id }}';$('#{{ idc.id }}').load(url+ ' #{{ idc.id }}');"
                                    class="text-center">展示或编辑机柜信息</a>

                            {% endif %}

                        </div>
>>>>>>> c05fe8bb68b7efd0498b5d17d87486202f6cdfbc
                        </div>

                    </div>
                    <!-- /.row  -->
                </div>

                <div class="box-footer">
                    <div class="inline pull-right">
                        <button class="btn btn-xs btn-primary"
                            onclick="window.open('http://127.0.0.1:8000/cmdb/cabDetail?idcId={{ idc.id }}')">
                            机柜图
                        </button>
                    </div>

                </div>
            </div>
        </div>
        {% endfor %}

    </div>
</div>
{% endblock main_content %}


{% block foot_js %}

  <!-- ----tab效果---- -->
    <script>
        $(document).ready(function () {
            $("#idc").attr("id", "current"); // Activate first tab
        });
    </script>
    <script type="text/javascript" src="/static/dist/layer/layer.js"></script>
    <script>
        $(function(){
            $("#f").change(function (){
                var args = $("#f").serialize();
                var x1 = "{%url 'cmdb:showGLC'%}?" + args;
                $("#guanlichu").load(x1 + " #guanlichu")
            });
        });

    </script>
{% endblock foot_js %}

<!-- ----tab效果---- -->
<script>
    $(document).ready(function () {
        $("#idc").attr("id", "current"); // Activate first tab
    });
</script>

{% endblock foot_js %}
